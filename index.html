<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz de No√´l</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #d32f2f, #388e3c);
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    .container {
        width: 95%;
        max-width: 600px;
        background: #fff8e1;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        padding: 20px;
        text-align: center;
    }
    img {
        max-width: 100%;
        border-radius: 10px;
        margin-bottom: 15px;
    }
    h1, h2 {
        color: #b71c1c;
    }
    button {
        background: #388e3c;
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 15px;
    }
    button:hover {
        background: #2e7d32;
    }
    input {
        width: 90%;
        padding: 10px;
        margin: 10px 0;
        border-radius: 8px;
        border: 1px solid #ccc;
    }
    .hidden {
        display: none;
    }
    .progress-bar {
        width: 100%;
        background: #eee;
        border-radius: 10px;
        overflow: hidden;
        margin: 15px 0;
    }
    .progress {
        height: 12px;
        background: #d32f2f;
        width: 0%;
        transition: width 0.4s ease;
    }
</style>
</head>
<body>

<div class="container" id="accueil">
    <h1>Bienvenue au Quiz de No√´l üéÑ</h1>
    <p>Testez vos connaissances sur la naissance de J√©sus et la f√™te de No√´l.</p>
    <button onclick="showLogin()">Commencer</button>
</div>

<div class="container hidden" id="login">
    <h2>Connexion</h2>
    <input type="text" id="nom" placeholder="Nom" required>
    <input type="text" id="prenom" placeholder="Pr√©nom" required>
    <input type="text" id="mouvement" placeholder="Mouvement de paroisse" required>
    <button onclick="startQuiz()">Se connecter</button>
</div>

<div class="container hidden" id="quiz">
    <div class="progress-bar"><div class="progress" id="progress"></div></div>
    <img id="quizImage" src="" alt="Image">
    <p id="quizText"></p>
    <h2 id="quizQuestion"></h2>
    <div id="options"></div>
    <button id="nextBtn" onclick="nextQuestion()" disabled>Suivant</button>
</div>

<div class="container hidden" id="felicitation">
    <h1>üéâ F√©licitations !</h1>
    <p id="finalMessage"></p>
    <p>Score : <span id="score"></span> / 6</p>
</div>

<script>
const questions = [
    { image: "images/noel.jpg", text: "No√´l est la f√™te o√π nous c√©l√©brons la naissance de J√©sus.", question: "Que c√©l√®bre-t-on √† No√´l ?", options: ["La naissance de J√©sus", "La naissance de Mo√Øse", "La naissance de Marie"], answer: "La naissance de J√©sus" },
    { image: "images/bethleem.jpg", text: "J√©sus est n√© √† Bethl√©em.", question: "Dans quelle ville J√©sus est-il n√© ?", options: ["Nazareth", "J√©rusalem", "Bethl√©em"], answer: "Bethl√©em" },
    { image: "images/bergers.jpg", text: "Les bergers ont √©t√© les premiers avertis.", question: "Qui a √©t√© averti en premier ?", options: ["Les rois mages", "Les bergers", "Les pr√™tres"], answer: "Les bergers" },
    { image: "images/etable.jpg", text: "Marie a donn√© naissance √† J√©sus dans une √©table.", question: "O√π Marie a-t-elle donn√© naissance ?", options: ["Dans un palais", "Dans une √©table", "Dans une auberge"], answer: "Dans une √©table" },
    { image: "images/creche.jpg", text: "La cr√®che repr√©sente la sc√®ne de la naissance.", question: "Quels personnages sont repr√©sent√©s ?", options: ["Marie, Joseph et J√©sus", "Marie, Joseph, J√©sus et les bergers", "Marie, Joseph, J√©sus, bergers et rois mages"], answer: "Marie, Joseph, J√©sus, bergers et rois mages" },
    { image: "images/messe.jpg", text: "La messe de No√´l est c√©l√©br√©e le 24 d√©cembre.", question: "Quand c√©l√®bre-t-on la messe de No√´l ?", options: ["Le 24 d√©cembre", "Le 31 d√©cembre", "Le 6 janvier"], answer: "Le 24 d√©cembre" }
];

let currentQuestion = 0;
let userName = "";
let score = 0;
let nom = "", prenom = "", mouvement = "";

// ‚úÖ Remplacez par votre URL Google Apps Script
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzHhAoYNnOoCSLDNSW0VzYcVKvc0D43ceB26KdBFoEFYDFk9O_wytM_hs92YsPVMTm-/exec";

function showLogin() {
    document.getElementById('accueil').classList.add('hidden');
    document.getElementById('login').classList.remove('hidden');
}

function startQuiz() {
    nom = document.getElementById('nom').value.trim();
    prenom = document.getElementById('prenom').value.trim();
    mouvement = document.getElementById('mouvement').value.trim();

    if(nom && prenom && mouvement) {
        userName = prenom;
        document.getElementById('login').classList.add('hidden');
        document.getElementById('quiz').classList.remove('hidden');
        loadQuestion();
    } else {
        alert("Veuillez remplir tous les champs.");
    }
}

function loadQuestion() {
    const q = questions[currentQuestion];
    document.getElementById('quizImage').src = q.image;
    document.getElementById('quizText').textContent = q.text;
    document.getElementById('quizQuestion').textContent = q.question;

    const optionsDiv = document.getElementById('options');
    optionsDiv.innerHTML = "";
    q.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.style.display = "block";
        btn.style.margin = "10px auto";
        btn.onclick = () => checkAnswer(opt);
        optionsDiv.appendChild(btn);
    });

    document.getElementById('nextBtn').disabled = true;
    updateProgress();
}

function checkAnswer(selected) {
    const correct = questions[currentQuestion].answer;
    if(selected === correct) {
        score++;
        alert("‚úÖ Bonne r√©ponse !");
        document.getElementById('nextBtn').disabled = false;
    } else {
        alert("‚ùå Mauvaise r√©ponse, essayez encore !");
    }
}

function nextQuestion() {
    currentQuestion++;
    if(currentQuestion < questions.length) {
        loadQuestion();
    } else {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('felicitation').classList.remove('hidden');
        document.getElementById('finalMessage').textContent = `Bravo ${userName}, vous avez termin√© le quiz !`;
        document.getElementById('score').textContent = score;

        // ‚úÖ Envoi des donn√©es √† Google Sheets
        sendToGoogleSheet();
    }
}

function updateProgress() {
    const progress = ((currentQuestion) / questions.length) * 100;
    document.getElementById('progress').style.width = progress + "%";
}

function sendToGoogleSheet() {
    const data = {
        nom: nom,
        prenom: prenom,
        mouvement: mouvement,
        score: score
    };
    fetch(GOOGLE_SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(data)
    }).then(response => {
        console.log("Donn√©es envoy√©es √† Google Sheets !");
    }).catch(error => {
        console.error("Erreur:", error);
    });
}
</script>

</body>
</html>
